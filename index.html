<!DOCTYPE html>
<html>
<head>
  <title>Introduction of Feature Hashing</title>
  <meta charset="utf-8">
  <meta name="description" content="Introduction of Feature Hashing">
  <meta name="author" content="Wush Wu">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012-wush/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012-wush/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012-wush/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/zenburn.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  <link rel=stylesheet href="./assets/css/custom.css"></link>
<link rel=stylesheet href="./assets/css/ribbons.css"></link>

  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="libraries/frameworks/io2012-wush/js/jquery-1.7.min.js"></script>
  <!-- <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> -->
  <script data-main="libraries/frameworks/io2012-wush/js/slides" 
    src="libraries/frameworks/io2012-wush/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>Introduction of Feature Hashing</h1>
    <h2>Create a Model Matrix via Feature Hashing with a Formula Interface</h2>
    <p>Wush Wu<br/>Taiwan R User Group</p>
  </hgroup>
  <article></article>  
</slide>
    

    <!-- SLIDES -->
    <slide class="largecontent" id="slide-1" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Wush, a Co-founder of Taiwan R User Group</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Ph.D. Student of National Taiwan Univ. </li>
<li>A Co-founder of Taiwan R User Group</li>
<li>A Contributor of R Packages</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="" id="slide-2" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Taiwan, a Mountainous Island</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;' class='centered'>
  <p><center><img src="assets/img/TaiwanMap.png" style="max-height: 80%; max-width: 80%;"/></center></p>

</div>
<div style='float:right;width:48%;' class='centered'>
  <ul>
<li>Area: 0.5% of Australia&#39;s</li>
<li>Population: 23 M \(\approx\) Australia&#39;s</li>
<li>Highest Mountain: Yushan (3952m)</li>
</ul>

<p><center><img src="assets/img/Mount_Yu_Shan_-_Taiwan.jpg" style="max-height: 100%; max-width: 100%;"/></center></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-3" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Taipei City and Taipei 101</h2>
  </hgroup>
  <article data-timings="">
    <p><center><img src="assets/img/tpnightview.jpg" style="max-height: 75%; max-width: 75%;"/></center>
<small>source: <a href="https://c2.staticflickr.com/6/5208/5231215951_c0e0036b17_b.jpg">https://c2.staticflickr.com/6/5208/5231215951_c0e0036b17_b.jpg</a></small></p>

<div style='float:left;width:48%;' class='centered'>
  
</div>
<div style='float:right;width:48%;' class='centered'>
  
</div>
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="" id="slide-4" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Night Market</h2>
  </hgroup>
  <article data-timings="">
    <p><center><img src="assets/img/nightmarket.jpg" style="max-height: 90%; max-width: 90%;"/></center></p>

<p>source: <a href="http://edition.cnn.com/2014/01/15/travel/10-things-taiwan/">http://edition.cnn.com/2014/01/15/travel/10-things-taiwan/</a></p>

  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-5" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Taiwan R User Group</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><a href="http://www.meetup.com/Taiwan-R">http://www.meetup.com/Taiwan-R</a></p>

<p><center><img src="assets/img/taiwan-r.jpg" style="max-height: 60%; max-width: 60%;"/></center></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="segue dark" id="slide-6" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Feature Vectorization and Formula Interface in R</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-7" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Algorithm in Text Book</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<h3>Regression</h3>

<p>\[y = X \beta + \varepsilon\]</p>

<h3>Real Data</h3>

<table><thead>
<tr>
<th align="left"></th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1</td>
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr>
<td align="left">2</td>
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr>
<td align="left">51</td>
<td align="right">7.0</td>
<td align="right">3.2</td>
<td align="right">4.7</td>
<td align="right">1.4</td>
<td align="left">versicolor</td>
</tr>
<tr>
<td align="left">52</td>
<td align="right">6.4</td>
<td align="right">3.2</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="left">versicolor</td>
</tr>
<tr>
<td align="left">101</td>
<td align="right">6.3</td>
<td align="right">3.3</td>
<td align="right">6.0</td>
<td align="right">2.5</td>
<td align="left">virginica</td>
</tr>
<tr>
<td align="left">102</td>
<td align="right">5.8</td>
<td align="right">2.7</td>
<td align="right">5.1</td>
<td align="right">1.9</td>
<td align="left">virginica</td>
</tr>
</tbody></table>

<ul>
<li>Where is \(X\) and \(y\)?</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-8" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Feature Vectorization and Formula Interface</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>\(X\) and \(y\) are constructed via <code>model.matrix</code> in R</li>
</ul>

<pre><code class="r">model.matrix(~ ., iris.demo)
</code></pre>

<table><thead>
<tr>
<th align="left"></th>
<th align="right">(Intercept)</th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="right">Speciesversicolor</th>
<th align="right">Speciesvirginica</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1</td>
<td align="right">1</td>
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">51</td>
<td align="right">1</td>
<td align="right">7.0</td>
<td align="right">3.2</td>
<td align="right">4.7</td>
<td align="right">1.4</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">52</td>
<td align="right">1</td>
<td align="right">6.4</td>
<td align="right">3.2</td>
<td align="right">4.5</td>
<td align="right">1.5</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">101</td>
<td align="right">1</td>
<td align="right">6.3</td>
<td align="right">3.3</td>
<td align="right">6.0</td>
<td align="right">2.5</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">102</td>
<td align="right">1</td>
<td align="right">5.8</td>
<td align="right">2.7</td>
<td align="right">5.1</td>
<td align="right">1.9</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody></table>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-9" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Formula Interface</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>y ~ model</code>

<ul>
<li><code>y</code> is modelled by a linear predictor specified symbolically by <code>model</code></li>
</ul></li>
<li>Available symbols is the column names of the <code>data.frame</code>. Take <code>iris</code> for example:

<ul>
<li><code>Sepal.Length</code></li>
<li><code>Sepal.Width</code></li>
<li><code>Petal.Length</code></li>
<li><code>Petal.Width</code></li>
<li><code>Species</code></li>
</ul></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-10" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Formula Interface</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>model.matrix(~ ., iris)</code>

<ul>
<li><code>.</code> represents the linear term of all columns but the response</li>
</ul></li>
</ul>

<pre><code class="r">all.equal(
  model.matrix(~., iris),
  model.matrix(~Sepal.Length+Sepal.Width+Petal.Length+Petal.Width+Species, iris)
  )
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">all.equal(
  model.matrix(Species ~ ., iris),
  model.matrix(Species ~ Sepal.Length+Sepal.Width+Petal.Length+Petal.Width, iris)
  )
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-11" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Operator in Formula</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>+</code>, the basic operator of linear predictors</li>
<li><code>:</code>, the interaction operator of linear predictor</li>
</ul>

<pre><code class="r">model.matrix(~ Sepal.Length+Sepal.Width+Sepal.Length:Sepal.Width, iris.demo)
</code></pre>

<table><thead>
<tr>
<th align="left"></th>
<th align="right">(Intercept)</th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Sepal.Length:Sepal.Width</th>
</tr>
</thead><tbody>
<tr>
<td align="left">1</td>
<td align="right">1</td>
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">17.85</td>
</tr>
<tr>
<td align="left">2</td>
<td align="right">1</td>
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">14.70</td>
</tr>
<tr>
<td align="left">51</td>
<td align="right">1</td>
<td align="right">7.0</td>
<td align="right">3.2</td>
<td align="right">22.40</td>
</tr>
<tr>
<td align="left">52</td>
<td align="right">1</td>
<td align="right">6.4</td>
<td align="right">3.2</td>
<td align="right">20.48</td>
</tr>
<tr>
<td align="left">101</td>
<td align="right">1</td>
<td align="right">6.3</td>
<td align="right">3.3</td>
<td align="right">20.79</td>
</tr>
<tr>
<td align="left">102</td>
<td align="right">1</td>
<td align="right">5.8</td>
<td align="right">2.7</td>
<td align="right">15.66</td>
</tr>
</tbody></table>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-12" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Operator in Formula</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>*</code>, factor crossing. For example, <code>a*b</code> is interpreted as <code>a+b+a:b</code></li>
<li><code>^</code>, the operator indicating crossing to the specified degree</li>
</ul>

<pre><code class="r">all.equal(
  model.matrix(~ Sepal.Length+Sepal.Width+Sepal.Length:Sepal.Width, iris.demo),
  model.matrix(~ Sepal.Length * Sepal.Width, iris.demo)
)
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">all.equal(
  model.matrix(~ (Sepal.Length + Sepal.Width)^2, iris.demo),
  model.matrix(~ (Sepal.Length + Sepal.Width) * (Sepal.Length + Sepal.Width), iris.demo)
)
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-13" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Please check <code>?formula</code></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="dark segue" id="slide-14" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Categorical Features</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-15" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Categorical Feature in R</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>A categorical variable of \(K\) categories =&gt; a sequence of \(K-1\) variables</li>
<li>There are some built-in contrasts:

<ul>
<li><code>contr.treatment</code></li>
<li><code>contr.poly</code></li>
<li><code>contr.sum</code></li>
<li><code>contr.treatment</code></li>
<li><code>contr.SAS</code></li>
</ul></li>
<li><a href="http://www.ats.ucla.edu/stat/r/library/contrast_coding.htm">http://www.ats.ucla.edu/stat/r/library/contrast_coding.htm</a></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-16" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Contrasts</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<pre><code class="r">model.matrix(~ Species, iris.demo)
</code></pre>

<pre><code>##     (Intercept) Speciesversicolor Speciesvirginica
## 1             1                 0                0
## 2             1                 0                0
## 51            1                 1                0
## 52            1                 1                0
## 101           1                 0                1
## 102           1                 0                1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$Species
## [1] &quot;contr.treatment&quot;
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-17" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Contrasts</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<pre><code class="r">contrasts(iris.demo$Species) &lt;- contr.sum(levels(iris.demo$Species))
model.matrix(~ Species, iris.demo)
</code></pre>

<pre><code>##     (Intercept) Species1 Species2
## 1             1        1        0
## 2             1        1        0
## 51            1        0        1
## 52            1        0        1
## 101           1       -1       -1
## 102           1       -1       -1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$Species
##            [,1] [,2]
## setosa        1    0
## versicolor    0    1
## virginica    -1   -1
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="dark segue" id="slide-18" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Motivation of the FeatureHashing</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-19" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Modeling Many Categorical Features</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Display Advertising</li>
<li>Text Mining</li>
</ul>

<p><center><img src="assets/img/Trouble.jpg" style="max-height: 100%; max-width: 100%;"/></center></p>

<p><small>source: <a href="http://seckora.com/wp-content/uploads/2014/06/computer-trouble.jpg">http://seckora.com/wp-content/uploads/2014/06/computer-trouble.jpg</a></small></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-20" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Display Advertising</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><center><img src="assets/img/Display_Ads_MatrixAdvertising_Wide.png" style="max-height: 100%; max-width: 100%;"/></center></p>

<p><small>source: <a href="http://images.dailytech.com/nimage/Display_Ads_MatrixAdvertising_Wide.png">http://images.dailytech.com/nimage/Display_Ads_MatrixAdvertising_Wide.png</a></small></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-21" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Kaggle: <a href="https://www.kaggle.com/c/criteo-display-ad-challenge">Display Advertising Challenge</a></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Training Dataset: a portion of <a href="http://www.criteo.com/">Criteo</a>&#39;s traffic over a period of 7 days.

<ul>
<li>Each instance corresponds to a display ad served by Criteo.</li>
<li>The reponse is positive if the ad viewer clicks the ad.</li>
</ul></li>
<li>Evaluation: The <a href="https://www.kaggle.com/wiki/LogarithmicLoss">Logarithmic Loss</a> of the prediction on the testing dataset.</li>
</ul>

<p><center><img src="assets/img/criteo-logo.png" style="max-height: 100%; max-width: 100%;"/></center></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-22" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>The Size of the Dataset</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>13 integer features and 26 categorical features</li>
<li>\(7 \times 10^7\) instances</li>
<li>There are many levels of categorical feature which do not appear in the training dataset.</li>
<li>The <a href="http://labs.criteo.com/downloads/2014-kaggle-display-advertising-challenge-dataset/">link</a></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-23" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Vectorize These Features in R</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>After binning the integer features, I got \(3 \times 10^7\) levels.</li>
<li>Sparse matrix was required

<ul>
<li>A dense matrix required 14PB memory...</li>
<li>A sparse matrix required 40GB memory...</li>
</ul></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-24" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Estimating Computing Resources</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Dense matrix: <code>nrow</code> (\(7 \times 10^7\)) \(\times\) <code>ncol</code> (\(3 \times 10^7)\) \(\times\) 8 bytes</li>
<li>Sparse matrix: <code>nrow</code> (\(7 \times 10^7\)) \(\times\) (\(13 + 26\)) \(\times\) (\(4 + 4 + 8\)) bytes</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-25" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Vectorize These Features in R</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>There was no implementation of the hashing trick in R, so I used <code>sparse.model.matrix</code> with a best machine in <a href="https://aws.amazon.com/tw/">Amazon Web Service</a>.</li>
<li>It took me many hours to design and implement the algorithm.</li>
<li>It took me many hours to run the scripts.</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-26" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Fit Model with Limited Memory</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>A post <a href="https://www.kaggle.com/c/criteo-display-ad-challenge/forums/t/10322/beat-the-benchmark-with-less-then-200mb-of-memory">Beat the benchmark with less then 200MB of memory</a> describes how to fit a model with limited resources.

<ul>
<li>online logistic regression</li>
<li>feature hash trick</li>
<li>adaptive learning rate</li>
</ul></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-27" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2><a href="https://en.wikipedia.org/wiki/Online_machine_learning">Online Machine Learning</a></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>In online learning, the model parameter is updated after the arrival of every new datapoint.</li>
<li>In batch learning, the model paramter is updated after access to the entire dataset.</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-28" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Limitation of <code>model.matrix</code></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><strong>The vectorization requires all levels of categorical features</strong>.</li>
</ul>

<pre><code class="r">contr.treatment(levels(iris$Species))
</code></pre>

<pre><code>##            versicolor virginica
## setosa              0         0
## versicolor          1         0
## virginica           0         1
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-29" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>\(f : \mathbb{Z} -> {0, 1, 2, ..., k}\)</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Mapping features to indices is one of method to vectorize feature. </li>
</ul>

<pre><code class="r">contr.treatment(levels(iris$Species))
</code></pre>

<pre><code>##            versicolor virginica
## setosa              0         0
## versicolor          1         0
## virginica           0         1
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-30" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>What is Feature Hashing?</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>A method to do feature vectorization with a <a href="https://en.wikipedia.org/wiki/Hash_function">hash function</a></li>
</ul>

<p><center><img src="assets/img/hash.jpeg" style="max-height: 150%; max-width: 150%;"/></center></p>

<ul>
<li>For example, Mod <code>%%</code> is a family of hash function.</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-31" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Feature Hashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Choose a hash function and use it to hash all the categorical features.</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-32" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>An Example of Feature Hashing of Criteo&#39;s Data</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<table><thead>
<tr>
<th align="left">V15</th>
<th align="left">V16</th>
<th align="left">V17</th>
</tr>
</thead><tbody>
<tr>
<td align="left">68fd1e64</td>
<td align="left">80e26c9b</td>
<td align="left">fb936136</td>
</tr>
<tr>
<td align="left">68fd1e64</td>
<td align="left">f0cf0024</td>
<td align="left">6f67f7e5</td>
</tr>
<tr>
<td align="left">287e684f</td>
<td align="left">0a519c5c</td>
<td align="left">02cf9876</td>
</tr>
<tr>
<td align="left">68fd1e64</td>
<td align="left">2c16a946</td>
<td align="left">a9a87e68</td>
</tr>
<tr>
<td align="left">8cf07265</td>
<td align="left">ae46a29d</td>
<td align="left">c81688bb</td>
</tr>
<tr>
<td align="left">05db9164</td>
<td align="left">6c9c9cf3</td>
<td align="left">2730ec9c</td>
</tr>
</tbody></table>

<ul>
<li>The categorical variables have been hashed onto 32 bits for anonymization purposes.</li>
<li>Let us use the last 4 bits as the hash result, i.e. the hash function is <code>function(x) x %% 16</code></li>
<li>The size of the vector is \((2^4)\), which is called <code>hash size</code></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-33" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>An Example of Feature Hashing of Criteo&#39;s Data</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<table><thead>
<tr>
<th align="left">V15</th>
<th align="left">V16</th>
<th align="left">V17</th>
</tr>
</thead><tbody>
<tr>
<td align="left">68fd1e64</td>
<td align="left">80e26c9b</td>
<td align="left">fb936136</td>
</tr>
<tr>
<td align="left">68fd1e64</td>
<td align="left">f0cf0024</td>
<td align="left">6f67f7e5</td>
</tr>
<tr>
<td align="left">287e684f</td>
<td align="left">0a519c5c</td>
<td align="left">02cf9876</td>
</tr>
<tr>
<td align="left">68fd1e64</td>
<td align="left">2c16a946</td>
<td align="left">a9a87e68</td>
</tr>
<tr>
<td align="left">8cf07265</td>
<td align="left">ae46a29d</td>
<td align="left">c81688bb</td>
</tr>
<tr>
<td align="left">05db9164</td>
<td align="left">6c9c9cf3</td>
<td align="left">2730ec9c</td>
</tr>
</tbody></table>

<ul>
<li><code>68fd1e64, 80e26c9b, fb936136</code> =&gt; <code>4, b, 6</code> 

<ul>
<li>\((0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0)\)</li>
</ul></li>
<li><code>68fd1e64, f0cf0024, 6f67f7e5</code> =&gt; <code>4, 4, 5</code>

<ul>
<li>\((0, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)\)</li>
</ul></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-34" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Hash Collision</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>68fd1e64, f0cf0024, 6f67f7e5</code> =&gt; <code>4, 4, 5</code>

<ul>
<li>\((0, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)\)</li>
</ul></li>
<li>Hash function is a <em>many to one</em> mapping, so different features might be mapped to the same index. This is called <em>collision</em>.</li>
<li>In the perspective of statistics, the <em>collision</em> in hash function makes the effect of these features confounding.</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-35" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Choosing Hash Function</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Less collision rate

<ul>
<li>Real features, such as text features, are not uniformly distributed in \(\mathbb{Z}\).</li>
</ul></li>
<li>High throughput</li>
<li><code>FeatureHashing</code> uses the <a href="https://code.google.com/p/smhasher/wiki/MurmurHash3">Murmurhash3</a> algorithm implemented by <a href="https://cran.r-project.org/web/packages/digest/index.html"><code>digest</code></a></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-36" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Pros of FeatureHashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<h3>A Good Companion of Online Algorithm</h3>

<pre><code class="r">library(FeatureHashing)
hash_size &lt;- 2^16
w &lt;- numeric(hash_size)
for(i in 1:1000) {
  data &lt;- fread(paste0(&quot;criteo&quot;, i))
  X &lt;- hashed.model.matrix(V1 ~ ., data, hash.size = hash_size)
  y &lt;- data$V1
  update_w(w, X, y)
}
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-37" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Pros of FeatureHashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<h3>A Good Companion of Distributed Algorithm</h3>

<pre><code class="r">library(pbdMPI)
library(FeatureHashing)
hash_size &lt;- 2^16
w &lt;- numeric(hash_size)
i &lt;- comm.rank()
data &lt;- fread(paste0(&quot;criteo&quot;, i))
X &lt;- hashed.model.matrix(V1 ~ ., data, hash.size = hash_size)
y &lt;- data$V1
# ...
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-38" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Pros of FeatureHashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<h3>Simple Training and Testing</h3>

<pre><code class="r">library(FeatureHashing)
model &lt;- is_click ~ ad * (url + ip)
m_train &lt;- hashed.model.matrix(model, data_train, hash_size)
m_test &lt;- hashed.model.matrix(model, data_test, hash_size)
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-39" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Cons of FeatureHashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<h3>Hash Size</h3>

<p><img src="assets/fig/cons1-1.png" alt="plot of chunk cons1"> </p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-40" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Cons of FeatureHashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<h3>Lose Interpretation</h3>

<ul>
<li>It is inconvenient to reverse the indices to feature.</li>
<li>Collision makes the interpretation harder.</li>
</ul>

<pre><code class="r">m &lt;- hashed.model.matrix(~ Species, iris, hash.size = 2^4, create.mapping = TRUE)
hash.mapping(m) %% 2^4
</code></pre>

<pre><code>##     Speciessetosa  Speciesvirginica Speciesversicolor 
##                 7                13                 8
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-41" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>The Result of the Competition...</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>No.1: <a href="http://ntucsu.csie.ntu.edu.tw/%7Ecjlin/libffm/">Field-aware Factorization Machine</a></li>
<li>No.3, no.4 and no.9 (we): Neuron Network</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="dark segue" id="slide-42" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Additional Features of <code>FeatureHashing</code></h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-43" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Another Story: Sentiment Analysis</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Provided by <a href="https://github.com/lewis-c">Lewis Crouch</a></li>
<li>Show the Pros of using FeatureHashing</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-44" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Dataset: <a href="https://www.kaggle.com/c/word2vec-nlp-tutorial">IMDB</a></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>Training Dataset: 25000 reviews</li>
<li>Binary response: positive or negative.</li>
</ul>

<pre><code>## [1] 1
</code></pre>

<ul>
<li>Cleaned review</li>
</ul>

<pre><code>## [1] &quot;kurosawa is a proved humanitarian this movie is totally about people living in&quot; 
## [2] &quot;poverty you will see nothing but angry in this movie it makes you feel bad but&quot; 
## [3] &quot;still worth all those who s too comfortable with materialization should spend 2&quot;
## [4] &quot;5 hours with this movie&quot;
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-45" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Tokenize</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<pre><code>##  [1] &quot;&quot;                &quot;kurosawa&quot;        &quot;is&quot;             
##  [4] &quot;a&quot;               &quot;proved&quot;          &quot;humanitarian&quot;   
##  [7] &quot;&quot;                &quot;this&quot;            &quot;movie&quot;          
## [10] &quot;is&quot;              &quot;totally&quot;         &quot;about&quot;          
## [13] &quot;people&quot;          &quot;living&quot;          &quot;in&quot;             
## [16] &quot;poverty&quot;         &quot;&quot;                &quot;you&quot;            
## [19] &quot;will&quot;            &quot;see&quot;             &quot;nothing&quot;        
## [22] &quot;but&quot;             &quot;angry&quot;           &quot;in&quot;             
## [25] &quot;this&quot;            &quot;movie&quot;           &quot;&quot;               
## [28] &quot;it&quot;              &quot;makes&quot;           &quot;you&quot;            
## [31] &quot;feel&quot;            &quot;bad&quot;             &quot;but&quot;            
## [34] &quot;still&quot;           &quot;worth&quot;           &quot;&quot;               
## [37] &quot;all&quot;             &quot;those&quot;           &quot;who&quot;            
## [40] &quot;s&quot;               &quot;too&quot;             &quot;comfortable&quot;    
## [43] &quot;with&quot;            &quot;materialization&quot; &quot;should&quot;         
## [46] &quot;spend&quot;           &quot;2&quot;               &quot;5&quot;              
## [49] &quot;hours&quot;           &quot;with&quot;            &quot;this&quot;           
## [52] &quot;movie&quot;           &quot;&quot;
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-46" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Tokenize and Vectorization</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<table><thead>
<tr>
<th align="left">id</th>
<th align="left">message</th>
<th align="left">hate</th>
<th align="left">bad</th>
<th align="left">like</th>
<th align="left">gratuitous</th>
</tr>
</thead><tbody>
<tr>
<td align="left">&quot;5814_8&quot;</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">&quot;2381_9&quot;</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">&quot;7759_3&quot;</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">&quot;3630_4&quot;</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">&quot;9495_8&quot;</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">&quot;8196_8&quot;</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody></table>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-47" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Additional Feature of <code>FeatureHashing</code></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>FeatureHashing</code> implements <code>split</code> in the formula interface.</li>
</ul>

<pre><code class="r">hash_size &lt;- 2^16
m.train &lt;- hashed.model.matrix(~ split(review, delim = &quot; &quot;, type = &quot;existence&quot;), 
                               data = imdb.train, 
                               hash.size = hash_size,
                               signed.hash = FALSE)
m.valid &lt;- hashed.model.matrix(~ split(review, delim = &quot; &quot;, type = &quot;existence&quot;), 
                              data = imdb.valid, 
                              hash.size = hash_size,
                              signed.hash = FALSE)
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-48" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Type of <code>split</code></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>existence</code></li>
<li><code>count</code></li>
<li><a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf"><code>tf-idf</code></a> which is contributed by <a href="https://github.com/pommedeterresautee">Michaël Benesty</a> and will be announced in v0.9.1</li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-49" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Gradient Boosted Decision Tree with <code>xgboost</code></h2>
</hgroup>
<article class = 'flexbox vcenter'>
<pre><code class="r">dtrain &lt;- xgb.DMatrix(m.train, label = imdb.train$sentiment)
dvalid &lt;- xgb.DMatrix(m.valid, label = imdb.valid$sentiment)
watch &lt;- list(train = dtrain, valid = dvalid)
g &lt;- xgb.train(booster = &quot;gblinear&quot;, nrounds = 100, eta = 0.0001, max.depth = 2,
                data = dtrain, objective = &quot;binary:logistic&quot;,
                watchlist = watch, eval_metric = &quot;auc&quot;)
</code></pre>

<pre><code>[0]  train-auc:0.969895 valid-auc:0.914488
[1] train-auc:0.969982  valid-auc:0.914621
[2] train-auc:0.970069  valid-auc:0.914766
...
[97]  train-auc:0.975616    valid-auc:0.922895
[98]    train-auc:0.975658  valid-auc:0.922952
[99]    train-auc:0.975700  valid-auc:0.923014
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-50" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Performance</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li>The <a href="https://www.kaggle.com/wiki/AUC">AUC</a> of <code>g</code> is \(0.90110\) in the <a href="https://www.kaggle.com/c/word2vec-nlp-tutorial/leaderboard?submissionId=1848642">public leader board</a> 

<ul>
<li>It outperforms the benchmark in Kaggle</li>
</ul></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-51" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>The Purpose of FeatureHashing</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><strong>Make our life easier</strong></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="dark segue" id="slide-52" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Extending Formula Interface in R</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-53" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><strong>Formula is the most R style interface</strong></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-54" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Tips</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>terms.formula</code> and its argument <code>specials</code></li>
</ul>

<pre><code class="r">tf &lt;- terms.formula(~ Plant * Type + conc * split(Treatment), specials = &quot;split&quot;, 
                    data = CO2)
attr(tf, &quot;factors&quot;)
</code></pre>

<pre><code>##                  Plant Type conc split(Treatment) Plant:Type
## Plant                1    0    0                0          1
## Type                 0    1    0                0          1
## conc                 0    0    1                0          0
## split(Treatment)     0    0    0                1          0
##                  conc:split(Treatment)
## Plant                                0
## Type                                 0
## conc                                 1
## split(Treatment)                     1
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-55" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Specials</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>attr(tf, &quot;specials&quot;)</code> tells which rows of <code>attr(tf, &quot;factors&quot;)</code> need to be parsed further</li>
</ul>

<pre><code class="r">rownames(attr(tf, &quot;factors&quot;))
</code></pre>

<pre><code>## [1] &quot;Plant&quot;            &quot;Type&quot;             &quot;conc&quot;            
## [4] &quot;split(Treatment)&quot;
</code></pre>

<pre><code class="r">attr(tf, &quot;specials&quot;)
</code></pre>

<pre><code>## $split
## [1] 4
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-56" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Parse</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><code>parse</code> extracts the information from the <code>specials</code></li>
</ul>

<pre><code class="r">options(keep.source = TRUE)
p &lt;- parse(text = rownames(attr(tf, &quot;factors&quot;))[4])
getParseData(p)
</code></pre>

<pre><code>##   line1 col1 line2 col2 id parent                token terminal      text
## 9     1    1     1   16  9      0                 expr    FALSE          
## 1     1    1     1    5  1      3 SYMBOL_FUNCTION_CALL     TRUE     split
## 3     1    1     1    5  3      9                 expr    FALSE          
## 2     1    6     1    6  2      9                  &#39;(&#39;     TRUE         (
## 4     1    7     1   15  4      6               SYMBOL     TRUE Treatment
## 6     1    7     1   15  6      9                 expr    FALSE          
## 5     1   16     1   16  5      9                  &#39;)&#39;     TRUE         )
</code></pre>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-57" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Efficiency</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<ul>
<li><a href="https://cran.r-project.org/web/packages/Rcpp/index.html"><code>Rcpp</code></a>

<ul>
<li>The core functions are implemented in C++</li>
</ul></li>
<li>Invoking external C functions

<ul>
<li><code>digest</code> exposes the C function:

<ul>
<li><a href="https://github.com/eddelbuettel/digest/blob/master/src/init.c">Register the c function</a></li>
<li><a href="https://github.com/eddelbuettel/digest/blob/master/inst/include/pmurhashAPI.h">Add the helper header file</a></li>
</ul></li>
<li><code>FeatureHashing</code> imports the C function:

<ul>
<li><a href="https://github.com/wush978/FeatureHashing/blob/master/src/digestlocal.h">Import the c function</a></li>
</ul></li>
</ul></li>
</ul>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-58" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Let&#39;s Discuss the Implementation Later</h2>
</hgroup>
<article class = 'flexbox vcenter'>
<p><center><img src="assets/img/commpraxis-audience-confusion.png" style="max-height: 75%; max-width: 75%;"/></center>
<small>source: <a href="http://www.commpraxis.com/wp-content/uploads/2015/01/commpraxis-audience-confusion.png">http://www.commpraxis.com/wp-content/uploads/2015/01/commpraxis-audience-confusion.png</a></small></p>

</article>
<!-- Presenter Notes -->
</slide>
<slide class="dark segue" id="slide-59" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;">
  <hgroup>
    <h2>Q&amp;A</h2>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>
<slide class="largecontent" id="slide-60" style="background-image: url('libraries/frameworks/io2012-wush/images/background.png'); background-repeat:no-repeat; background-position:center; background-size: 100% 100%;" >
<hgroup>
  <h2>Thanks You</h2>
</hgroup>
<article class = 'flexbox vcenter'>

</article>
<!-- Presenter Notes -->
</slide>
    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='Wush, a Co-founder of Taiwan R User Group'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='Taiwan, a Mountainous Island'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='Taipei City and Taipei 101'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='Night Market'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title='Taiwan R User Group'>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title='Feature Vectorization and Formula Interface in R'>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='Algorithm in Text Book'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='Feature Vectorization and Formula Interface'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='Formula Interface'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title='Formula Interface'>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='Operator in Formula'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='Operator in Formula'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title=''>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='Categorical Features'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='Categorical Feature in R'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Contrasts'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='Contrasts'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='Motivation of the FeatureHashing'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='Modeling Many Categorical Features'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='Display Advertising'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='Kaggle: <a href="https://www.kaggle.com/c/criteo-display-ad-challenge">Display Advertising Challenge</a>'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='The Size of the Dataset'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='Vectorize These Features in R'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title='Estimating Computing Resources'>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title='Vectorize These Features in R'>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='Fit Model with Limited Memory'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title='<a href="https://en.wikipedia.org/wiki/Online_machine_learning">Online Machine Learning</a>'>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title='Limitation of <code>model.matrix</code>'>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title='\(f : \mathbb{Z} -> {0, 1, 2, ..., k}\)'>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title='What is Feature Hashing?'>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='Feature Hashing'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='An Example of Feature Hashing of Criteo&#39;s Data'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title='An Example of Feature Hashing of Criteo&#39;s Data'>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title='Hash Collision'>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='Choosing Hash Function'>
         35
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=36 title='Pros of FeatureHashing'>
         36
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=37 title='Pros of FeatureHashing'>
         37
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=38 title='Pros of FeatureHashing'>
         38
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=39 title='Cons of FeatureHashing'>
         39
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=40 title='Cons of FeatureHashing'>
         40
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=41 title='The Result of the Competition...'>
         41
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=42 title='Additional Features of <code>FeatureHashing</code>'>
         42
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=43 title='Another Story: Sentiment Analysis'>
         43
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=44 title='Dataset: <a href="https://www.kaggle.com/c/word2vec-nlp-tutorial">IMDB</a>'>
         44
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=45 title='Tokenize'>
         45
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=46 title='Tokenize and Vectorization'>
         46
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=47 title='Additional Feature of <code>FeatureHashing</code>'>
         47
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=48 title='Type of <code>split</code>'>
         48
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=49 title='Gradient Boosted Decision Tree with <code>xgboost</code>'>
         49
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=50 title='Performance'>
         50
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=51 title='The Purpose of FeatureHashing'>
         51
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=52 title='Extending Formula Interface in R'>
         52
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=53 title=''>
         53
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=54 title='Tips'>
         54
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=55 title='Specials'>
         55
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=56 title='Parse'>
         56
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=57 title='Efficiency'>
         57
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=58 title='Let&#39;s Discuss the Implementation Later'>
         58
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=59 title='Q&amp;A'>
         59
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=60 title='Thanks You'>
         60
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  
  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>